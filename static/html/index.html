<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VLAN Manager</title>
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <div class="theme-toggle" id="themeToggle">
        <span class="theme-icon" id="themeIcon">üåô</span>
        <span id="themeText">Dark</span>
    </div>
    
    <div class="container">
        <div class="header-bar">
            <h1 style="margin: 0;">üåê VLAN Segment Manager</h1>
            <div class="header-actions">
                <button id="loginBtn" class="btn btn-primary" style="display: none;">
                    üîê Login
                </button>
                <div id="authSection" style="display: none;">
                    <span id="userGreeting" style="color: white; margin-right: 10px; font-size: 14px;"></span>
                    <button id="logoutBtn" class="btn btn-secondary">Logout</button>
                </div>
            </div>
        </div>
        
        <!-- Login Modal -->
        <div id="loginModal" class="modal" style="display: none;">
            <div class="modal-content login-modal-content">
                <div class="modal-header">
                    <h2>üîê Login</h2>
                    <button class="close-modal" onclick="closeLoginModal()">&times;</button>
                </div>
                <form id="loginForm">
                    <p style="margin-bottom: 20px; color: var(--text-secondary); text-align: center;">
                        Login to create, update, or delete segments
                    </p>
                    <div class="form-group">
                        <label for="loginUsername">Username</label>
                        <input type="text" id="loginUsername" placeholder="Enter username" required autofocus>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" placeholder="Enter password" required>
                    </div>
                    <div id="loginError" class="error-banner" style="display: none; margin-bottom: 15px;"></div>
                    <div style="display: flex; gap: 10px;">
                        <button type="button" class="btn btn-secondary" onclick="closeLoginModal()" style="flex: 1;">Cancel</button>
                        <button type="submit" class="btn btn-primary" style="flex: 1;">Login</button>
                    </div>
                </form>
            </div>
        </div>
        
        <div id="errorBanner" class="error-banner"></div>
        <div id="successBanner" class="success-banner"></div>
        
        <div class="stats-grid" id="statsGrid">
            <div class="stat-card">
                <h3>Loading...</h3>
            </div>
        </div>
        
        <div class="main-content">
            <div class="card" id="addSegmentCard" style="display: none;">
                <h2>Add Segment</h2>
                <form id="addSegmentForm">
                    <div class="form-group">
                        <label for="segmentVrf">VRF / Network</label>
                        <select id="segmentVrf" required>
                            <option value="">Select VRF...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="segmentSite">Site</label>
                        <select id="segmentSite" required>
                            <option value="">Select site...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="vlanId">VLAN ID</label>
                        <input type="number" id="vlanId" min="1" max="4094" placeholder="100" required>
                    </div>
                    <div class="form-group">
                        <label for="epgName">EPG Name</label>
                        <input type="text" id="epgName" placeholder="EPG_PROD_01" required>
                    </div>
                    <div class="form-group">
                        <label for="networkSegment">Network Segment</label>
                        <input type="text" id="networkSegment" placeholder="192.168.1.0/24" required>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="segmentDhcp">
                            <span>DHCP Enabled</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="segmentDescription">Description (Optional)</label>
                        <input type="text" id="segmentDescription" placeholder="Additional notes">
                    </div>
                    <button type="submit" id="addSegmentBtn">Add Segment</button>
                </form>
            </div>
            
            <div class="card" id="allocateCard" style="display: none;">
                <h2>Allocate Segment</h2>
                <form id="allocateForm">
                    <div class="form-group">
                        <label for="allocationVrf">Network (VRF)</label>
                        <select id="allocationVrf" required>
                            <option value="">Select Network...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="allocationSite">Site</label>
                        <select id="allocationSite" required>
                            <option value="">Select site...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="clusterName">Cluster Name</label>
                        <input type="text" id="clusterName" placeholder="cluster-prod-01" required>
                    </div>
                    <button type="submit" id="allocateBtn">Allocate Segment</button>
                </form>

                <div id="allocationResult" style="margin-top: 20px;"></div>
            </div>
        </div>
        
        <div class="card full-width" id="bulkImportCard" style="display: none;">
            <h2>Bulk Import Segments</h2>
            <div class="form-group">
                <label for="bulkImport">Paste CSV data (site,vlan_id,epg_name,segment,vrf,dhcp,description)</label>
                <textarea id="bulkImport" placeholder="site1,100,EPG_PROD_01,192.168.1.0/24,Network1,true,Production segment
site1,101,EPG_PROD_02,192.168.2.0/24,Network1,false,Production segment 2
site2,200,EPG_DEV_01,10.0.1.0/24,true,Development segment"></textarea>
            </div>
            <button onclick="importBulk()">Import Segments</button>
        </div>
        
        <div class="card full-width">
            <div class="segments-header">
                <h2>Segments</h2>
                <div class="export-buttons">
                    <button class="btn btn-secondary" onclick="exportData('csv')">üìä Export CSV</button>
                    <button class="btn btn-secondary" onclick="exportData('excel')">üìã Export Excel</button>
                    <button class="btn btn-secondary" onclick="exportStats('csv')">üìà Export Stats</button>
                </div>
            </div>
            <div class="filters">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Search by cluster name, EPG, VLAN ID, or segment..." class="search-input">
                    <button id="clearSearch" class="clear-search" title="Clear search">‚úï</button>
                </div>
                <div class="status-tabs">
                    <div class="tab active" data-filter="all">All</div>
                    <div class="tab" data-filter="available">Available</div>
                    <div class="tab" data-filter="allocated">Allocated</div>
                </div>
                <div class="site-filter">
                    <label for="siteFilter">Filter by Site:</label>
                    <select id="siteFilter">
                        <option value="">All Sites</option>
                    </select>
                </div>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Site</th>
                            <th>VRF</th>
                            <th>VLAN ID</th>
                            <th>EPG Name</th>
                            <th>Network Segment</th>
                            <th>DHCP</th>
                            <th>Cluster</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="segmentsList">
                        <tr>
                            <td colspan="9" class="empty-state">Loading segments...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Help Button - Bottom Center -->
        <div style="text-align: center; margin: 40px 0 20px 0;">
            <a href="/static/html/help.html" style="background: var(--primary-color); color: white; padding: 12px 30px; text-decoration: none; border-radius: 8px; font-weight: 500; display: inline-block; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">üìö Help & Documentation</a>
        </div>
    </div>
    
    <div class="connection-status">
        <div class="status-dot" id="statusDot"></div>
        <span id="statusText">Connected</span>
    </div>
    
    <script src="/static/js/app.js"></script>
</body>
</html>